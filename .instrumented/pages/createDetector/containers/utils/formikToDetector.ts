function cov_2p41f40ap8() {
  var path = "/Users/yizheliu/casesafe/workspace/kibana-780/kibana/plugins/anomaly-detection-kibana-plugin/public/pages/createDetector/containers/utils/formikToDetector.ts";
  var hash = "6dd7f1b091053e1da54ca660a3c8d671876985e5";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/yizheliu/casesafe/workspace/kibana-780/kibana/plugins/anomaly-detection-kibana-plugin/public/pages/createDetector/containers/utils/formikToDetector.ts",
    statementMap: {
      "0": {
        start: {
          line: 30,
          column: 20
        },
        end: {
          line: 30,
          column: 22
        }
      },
      "1": {
        start: {
          line: 31,
          column: 2
        },
        end: {
          line: 40,
          column: 3
        }
      },
      "2": {
        start: {
          line: 32,
          column: 4
        },
        end: {
          line: 32,
          column: 54
        }
      },
      "3": {
        start: {
          line: 34,
          column: 4
        },
        end: {
          line: 39,
          column: 5
        }
      },
      "4": {
        start: {
          line: 35,
          column: 6
        },
        end: {
          line: 35,
          column: 51
        }
      },
      "5": {
        start: {
          line: 38,
          column: 6
        },
        end: {
          line: 38,
          column: 23
        }
      },
      "6": {
        start: {
          line: 41,
          column: 18
        },
        end: {
          line: 41,
          column: 47
        }
      },
      "7": {
        start: {
          line: 42,
          column: 21
        },
        end: {
          line: 42,
          column: 57
        }
      },
      "8": {
        start: {
          line: 44,
          column: 19
        },
        end: {
          line: 60,
          column: 15
        }
      },
      "9": {
        start: {
          line: 62,
          column: 2
        },
        end: {
          line: 62,
          column: 20
        }
      },
      "10": {
        start: {
          line: 65,
          column: 34
        },
        end: {
          line: 74,
          column: 1
        }
      },
      "11": {
        start: {
          line: 69,
          column: 2
        },
        end: {
          line: 73,
          column: 4
        }
      },
      "12": {
        start: {
          line: 76,
          column: 41
        },
        end: {
          line: 77,
          column: 35
        }
      },
      "13": {
        start: {
          line: 77,
          column: 2
        },
        end: {
          line: 77,
          column: 35
        }
      },
      "14": {
        start: {
          line: 79,
          column: 35
        },
        end: {
          line: 94,
          column: 1
        }
      },
      "15": {
        start: {
          line: 82,
          column: 2
        },
        end: {
          line: 93,
          column: 3
        }
      },
      "16": {
        start: {
          line: 83,
          column: 22
        },
        end: {
          line: 85,
          column: 6
        }
      },
      "17": {
        start: {
          line: 84,
          column: 6
        },
        end: {
          line: 84,
          column: 64
        }
      },
      "18": {
        start: {
          line: 86,
          column: 4
        },
        end: {
          line: 90,
          column: 6
        }
      },
      "19": {
        start: {
          line: 92,
          column: 4
        },
        end: {
          line: 92,
          column: 29
        }
      },
      "20": {
        start: {
          line: 96,
          column: 24
        },
        end: {
          line: 97,
          column: 35
        }
      },
      "21": {
        start: {
          line: 97,
          column: 2
        },
        end: {
          line: 97,
          column: 35
        }
      },
      "22": {
        start: {
          line: 97,
          column: 23
        },
        end: {
          line: 97,
          column: 34
        }
      }
    },
    fnMap: {
      "0": {
        name: "formikToDetector",
        decl: {
          start: {
            line: 26,
            column: 16
          },
          end: {
            line: 26,
            column: 32
          }
        },
        loc: {
          start: {
            line: 29,
            column: 12
          },
          end: {
            line: 63,
            column: 1
          }
        },
        line: 29
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 65,
            column: 34
          },
          end: {
            line: 65,
            column: 35
          }
        },
        loc: {
          start: {
            line: 68,
            column: 5
          },
          end: {
            line: 74,
            column: 1
          }
        },
        line: 68
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 76,
            column: 41
          },
          end: {
            line: 76,
            column: 42
          }
        },
        loc: {
          start: {
            line: 77,
            column: 2
          },
          end: {
            line: 77,
            column: 35
          }
        },
        line: 77
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 79,
            column: 35
          },
          end: {
            line: 79,
            column: 36
          }
        },
        loc: {
          start: {
            line: 81,
            column: 29
          },
          end: {
            line: 94,
            column: 1
          }
        },
        line: 81
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 83,
            column: 34
          },
          end: {
            line: 83,
            column: 35
          }
        },
        loc: {
          start: {
            line: 83,
            column: 56
          },
          end: {
            line: 85,
            column: 5
          }
        },
        line: 83
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 96,
            column: 24
          },
          end: {
            line: 96,
            column: 25
          }
        },
        loc: {
          start: {
            line: 97,
            column: 2
          },
          end: {
            line: 97,
            column: 35
          }
        },
        line: 97
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 97,
            column: 14
          },
          end: {
            line: 97,
            column: 15
          }
        },
        loc: {
          start: {
            line: 97,
            column: 23
          },
          end: {
            line: 97,
            column: 34
          }
        },
        line: 97
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 31,
            column: 2
          },
          end: {
            line: 40,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 31,
            column: 2
          },
          end: {
            line: 40,
            column: 3
          }
        }, {
          start: {
            line: 31,
            column: 2
          },
          end: {
            line: 40,
            column: 3
          }
        }],
        line: 31
      },
      "1": {
        loc: {
          start: {
            line: 77,
            column: 2
          },
          end: {
            line: 77,
            column: 35
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 77,
            column: 23
          },
          end: {
            line: 77,
            column: 30
          }
        }, {
          start: {
            line: 77,
            column: 33
          },
          end: {
            line: 77,
            column: 35
          }
        }],
        line: 77
      },
      "2": {
        loc: {
          start: {
            line: 82,
            column: 2
          },
          end: {
            line: 93,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 82,
            column: 2
          },
          end: {
            line: 93,
            column: 3
          }
        }, {
          start: {
            line: 82,
            column: 2
          },
          end: {
            line: 93,
            column: 3
          }
        }],
        line: 82
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "6dd7f1b091053e1da54ca660a3c8d671876985e5"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2p41f40ap8 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}

cov_2p41f40ap8();

/*
 * Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License").
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */
import { Detector, UIFilter, FILTER_TYPES, UNITS } from '../../../../models/interfaces';
import { ADFormikValues } from '../models/interfaces';
import { OPERATORS_QUERY_MAP } from './whereFilters';
import { get } from 'lodash';
export function formikToDetector(values: ADFormikValues, detector: Detector): Detector {
  cov_2p41f40ap8().f[0]++;
  let filterQuery = (cov_2p41f40ap8().s[0]++, {});
  cov_2p41f40ap8().s[1]++;

  if (values.filterType === FILTER_TYPES.SIMPLE) {
    cov_2p41f40ap8().b[0][0]++;
    cov_2p41f40ap8().s[2]++;
    filterQuery = formikToFilterQuery(values.filters);
  } else {
    cov_2p41f40ap8().b[0][1]++;
    cov_2p41f40ap8().s[3]++;

    try {
      cov_2p41f40ap8().s[4]++;
      filterQuery = JSON.parse(values.filterQuery);
    } catch (e) {
      cov_2p41f40ap8().s[5]++;
      //This should mostly not happen as we've have validation before submit
      filterQuery = {};
    }
  }

  const indices = (cov_2p41f40ap8().s[6]++, formikToIndices(values.index));
  const uiMetaData = (cov_2p41f40ap8().s[7]++, formikToUIMetadata(values, detector));
  let apiRequest = (cov_2p41f40ap8().s[8]++, ({ ...detector,
    name: values.detectorName,
    description: values.detectorDescription,
    timeField: values.timeField,
    indices,
    filterQuery: { ...filterQuery
    },
    uiMetadata: uiMetaData,
    detectionInterval: {
      period: {
        interval: values.detectionInterval,
        unit: UNITS.MINUTES
      }
    },
    windowDelay: {
      period: {
        interval: values.windowDelay,
        unit: UNITS.MINUTES
      }
    }
  } as Detector));
  cov_2p41f40ap8().s[9]++;
  return apiRequest;
}
cov_2p41f40ap8().s[10]++;
export const formikToUIMetadata = (values: ADFormikValues, detector: Detector) => {
  cov_2p41f40ap8().f[1]++;
  cov_2p41f40ap8().s[11]++;
  return {
    filterType: values.filterType,
    filters: formikFiltersToUiMetadata(values.filters),
    features: get(detector, 'uiMetadata.features', {})
  };
};
cov_2p41f40ap8().s[12]++;
export const formikFiltersToUiMetadata = (filters: UIFilter[]) => {
  cov_2p41f40ap8().f[2]++;
  cov_2p41f40ap8().s[13]++;
  return filters.length > 0 ? (cov_2p41f40ap8().b[1][0]++, filters) : (cov_2p41f40ap8().b[1][1]++, []);
};
cov_2p41f40ap8().s[14]++;
export const formikToFilterQuery = (filters: UIFilter[]): {
  [key: string]: any;
} => {
  cov_2p41f40ap8().f[3]++;
  cov_2p41f40ap8().s[15]++;

  if (filters.length > 0) {
    cov_2p41f40ap8().b[2][0]++;
    const esFilters = (cov_2p41f40ap8().s[16]++, filters.map((filter: UIFilter) => {
      cov_2p41f40ap8().f[4]++;
      cov_2p41f40ap8().s[17]++;
      return OPERATORS_QUERY_MAP[filter.operator].query(filter);
    }));
    cov_2p41f40ap8().s[18]++;
    return {
      bool: {
        filter: [...esFilters]
      }
    };
  } else {
    cov_2p41f40ap8().b[2][1]++;
    cov_2p41f40ap8().s[19]++;
    return {
      match_all: {}
    };
  }
};
cov_2p41f40ap8().s[20]++;

const formikToIndices = (indices: {
  label: string;
}[]) => {
  cov_2p41f40ap8().f[5]++;
  cov_2p41f40ap8().s[21]++;
  return indices.map(index => {
    cov_2p41f40ap8().f[6]++;
    cov_2p41f40ap8().s[22]++;
    return index.label;
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm1pa1RvRGV0ZWN0b3IudHMiXSwibmFtZXMiOlsiRGV0ZWN0b3IiLCJVSUZpbHRlciIsIkZJTFRFUl9UWVBFUyIsIlVOSVRTIiwiQURGb3JtaWtWYWx1ZXMiLCJPUEVSQVRPUlNfUVVFUllfTUFQIiwiZ2V0IiwiZm9ybWlrVG9EZXRlY3RvciIsInZhbHVlcyIsImRldGVjdG9yIiwiZmlsdGVyUXVlcnkiLCJmaWx0ZXJUeXBlIiwiU0lNUExFIiwiZm9ybWlrVG9GaWx0ZXJRdWVyeSIsImZpbHRlcnMiLCJKU09OIiwicGFyc2UiLCJlIiwiaW5kaWNlcyIsImZvcm1pa1RvSW5kaWNlcyIsImluZGV4IiwidWlNZXRhRGF0YSIsImZvcm1pa1RvVUlNZXRhZGF0YSIsImFwaVJlcXVlc3QiLCJuYW1lIiwiZGV0ZWN0b3JOYW1lIiwiZGVzY3JpcHRpb24iLCJkZXRlY3RvckRlc2NyaXB0aW9uIiwidGltZUZpZWxkIiwidWlNZXRhZGF0YSIsImRldGVjdGlvbkludGVydmFsIiwicGVyaW9kIiwiaW50ZXJ2YWwiLCJ1bml0IiwiTUlOVVRFUyIsIndpbmRvd0RlbGF5IiwiZm9ybWlrRmlsdGVyc1RvVWlNZXRhZGF0YSIsImZlYXR1cmVzIiwibGVuZ3RoIiwia2V5IiwiZXNGaWx0ZXJzIiwibWFwIiwiZmlsdGVyIiwib3BlcmF0b3IiLCJxdWVyeSIsImJvb2wiLCJtYXRjaF9hbGwiLCJsYWJlbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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UCxHQUFWLEtBQ3RCO0FBQUE7QUFBQTtBQUFBLFNBQUE3QixPQUFPLENBQUN1QixHQUFSLENBQVlyQixLQUFLLElBQUk7QUFBQTtBQUFBO0FBQUEsV0FBQUEsS0FBSyxDQUFDMkIsS0FBTjtBQUFXLEdBQWhDO0FBQWlDLENBRG5DIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAyMDE5IEFtYXpvbi5jb20sIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS5cbiAqIFlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogb3IgaW4gdGhlIFwibGljZW5zZVwiIGZpbGUgYWNjb21wYW55aW5nIHRoaXMgZmlsZS4gVGhpcyBmaWxlIGlzIGRpc3RyaWJ1dGVkXG4gKiBvbiBhbiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXJcbiAqIGV4cHJlc3Mgb3IgaW1wbGllZC4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nXG4gKiBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgRGV0ZWN0b3IsXG4gIFVJRmlsdGVyLFxuICBGSUxURVJfVFlQRVMsXG4gIFVOSVRTLFxufSBmcm9tICcuLi8uLi8uLi8uLi9tb2RlbHMvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBBREZvcm1pa1ZhbHVlcyB9IGZyb20gJy4uL21vZGVscy9pbnRlcmZhY2VzJztcbmltcG9ydCB7IE9QRVJBVE9SU19RVUVSWV9NQVAgfSBmcm9tICcuL3doZXJlRmlsdGVycyc7XG5pbXBvcnQgeyBnZXQgfSBmcm9tICdsb2Rhc2gnO1xuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWlrVG9EZXRlY3RvcihcbiAgdmFsdWVzOiBBREZvcm1pa1ZhbHVlcyxcbiAgZGV0ZWN0b3I6IERldGVjdG9yXG4pOiBEZXRlY3RvciB7XG4gIGxldCBmaWx0ZXJRdWVyeSA9IHt9O1xuICBpZiAodmFsdWVzLmZpbHRlclR5cGUgPT09IEZJTFRFUl9UWVBFUy5TSU1QTEUpIHtcbiAgICBmaWx0ZXJRdWVyeSA9IGZvcm1pa1RvRmlsdGVyUXVlcnkodmFsdWVzLmZpbHRlcnMpO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICBmaWx0ZXJRdWVyeSA9IEpTT04ucGFyc2UodmFsdWVzLmZpbHRlclF1ZXJ5KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvL1RoaXMgc2hvdWxkIG1vc3RseSBub3QgaGFwcGVuIGFzIHdlJ3ZlIGhhdmUgdmFsaWRhdGlvbiBiZWZvcmUgc3VibWl0XG4gICAgICBmaWx0ZXJRdWVyeSA9IHt9O1xuICAgIH1cbiAgfVxuICBjb25zdCBpbmRpY2VzID0gZm9ybWlrVG9JbmRpY2VzKHZhbHVlcy5pbmRleCk7XG4gIGNvbnN0IHVpTWV0YURhdGEgPSBmb3JtaWtUb1VJTWV0YWRhdGEodmFsdWVzLCBkZXRlY3Rvcik7XG5cbiAgbGV0IGFwaVJlcXVlc3QgPSB7XG4gICAgLi4uZGV0ZWN0b3IsXG4gICAgbmFtZTogdmFsdWVzLmRldGVjdG9yTmFtZSxcbiAgICBkZXNjcmlwdGlvbjogdmFsdWVzLmRldGVjdG9yRGVzY3JpcHRpb24sXG4gICAgdGltZUZpZWxkOiB2YWx1ZXMudGltZUZpZWxkLFxuICAgIGluZGljZXMsXG4gICAgZmlsdGVyUXVlcnk6IHtcbiAgICAgIC4uLmZpbHRlclF1ZXJ5LFxuICAgIH0sXG4gICAgdWlNZXRhZGF0YTogdWlNZXRhRGF0YSxcbiAgICBkZXRlY3Rpb25JbnRlcnZhbDoge1xuICAgICAgcGVyaW9kOiB7IGludGVydmFsOiB2YWx1ZXMuZGV0ZWN0aW9uSW50ZXJ2YWwsIHVuaXQ6IFVOSVRTLk1JTlVURVMgfSxcbiAgICB9LFxuICAgIHdpbmRvd0RlbGF5OiB7XG4gICAgICBwZXJpb2Q6IHsgaW50ZXJ2YWw6IHZhbHVlcy53aW5kb3dEZWxheSwgdW5pdDogVU5JVFMuTUlOVVRFUyB9LFxuICAgIH0sXG4gIH0gYXMgRGV0ZWN0b3I7XG5cbiAgcmV0dXJuIGFwaVJlcXVlc3Q7XG59XG5cbmV4cG9ydCBjb25zdCBmb3JtaWtUb1VJTWV0YWRhdGEgPSAoXG4gIHZhbHVlczogQURGb3JtaWtWYWx1ZXMsXG4gIGRldGVjdG9yOiBEZXRlY3RvclxuKSA9PiB7XG4gIHJldHVybiB7XG4gICAgZmlsdGVyVHlwZTogdmFsdWVzLmZpbHRlclR5cGUsXG4gICAgZmlsdGVyczogZm9ybWlrRmlsdGVyc1RvVWlNZXRhZGF0YSh2YWx1ZXMuZmlsdGVycyksXG4gICAgZmVhdHVyZXM6IGdldChkZXRlY3RvciwgJ3VpTWV0YWRhdGEuZmVhdHVyZXMnLCB7fSksXG4gIH07XG59O1xuXG5leHBvcnQgY29uc3QgZm9ybWlrRmlsdGVyc1RvVWlNZXRhZGF0YSA9IChmaWx0ZXJzOiBVSUZpbHRlcltdKSA9PlxuICBmaWx0ZXJzLmxlbmd0aCA+IDAgPyBmaWx0ZXJzIDogW107XG5cbmV4cG9ydCBjb25zdCBmb3JtaWtUb0ZpbHRlclF1ZXJ5ID0gKFxuICBmaWx0ZXJzOiBVSUZpbHRlcltdXG4pOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0+IHtcbiAgaWYgKGZpbHRlcnMubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGVzRmlsdGVycyA9IGZpbHRlcnMubWFwKChmaWx0ZXI6IFVJRmlsdGVyKSA9PiB7XG4gICAgICByZXR1cm4gT1BFUkFUT1JTX1FVRVJZX01BUFtmaWx0ZXIub3BlcmF0b3JdLnF1ZXJ5KGZpbHRlcik7XG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGJvb2w6IHtcbiAgICAgICAgZmlsdGVyOiBbLi4uZXNGaWx0ZXJzXSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4geyBtYXRjaF9hbGw6IHt9IH07XG4gIH1cbn07XG5cbmNvbnN0IGZvcm1pa1RvSW5kaWNlcyA9IChpbmRpY2VzOiB7IGxhYmVsOiBzdHJpbmcgfVtdKSA9PlxuICBpbmRpY2VzLm1hcChpbmRleCA9PiBpbmRleC5sYWJlbCk7XG4iXX0=