function cov_1vekg96fvu() {
  var path = "/Users/yizheliu/casesafe/workspace/kibana-780/kibana/plugins/anomaly-detection-kibana-plugin/public/pages/EditFeatures/containers/utils/formikToFeatures.ts";
  var hash = "6f05395d6a30344785ebd6c9340d68bb32a013f1";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/yizheliu/casesafe/workspace/kibana-780/kibana/plugins/anomaly-detection-kibana-plugin/public/pages/EditFeatures/containers/utils/formikToFeatures.ts",
    statementMap: {
      "0": {
        start: {
          line: 42,
          column: 19
        },
        end: {
          line: 42,
          column: 32
        }
      },
      "1": {
        start: {
          line: 43,
          column: 28
        },
        end: {
          line: 43,
          column: 64
        }
      },
      "2": {
        start: {
          line: 45,
          column: 2
        },
        end: {
          line: 52,
          column: 4
        }
      },
      "3": {
        start: {
          line: 56,
          column: 2
        },
        end: {
          line: 68,
          column: 3
        }
      },
      "4": {
        start: {
          line: 61,
          column: 4
        },
        end: {
          line: 65,
          column: 6
        }
      },
      "5": {
        start: {
          line: 67,
          column: 4
        },
        end: {
          line: 67,
          column: 14
        }
      },
      "6": {
        start: {
          line: 72,
          column: 2
        },
        end: {
          line: 82,
          column: 3
        }
      },
      "7": {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 81,
          column: 11
        }
      },
      "8": {
        start: {
          line: 83,
          column: 2
        },
        end: {
          line: 83,
          column: 45
        }
      },
      "9": {
        start: {
          line: 90,
          column: 27
        },
        end: {
          line: 90,
          column: 72
        }
      },
      "10": {
        start: {
          line: 91,
          column: 2
        },
        end: {
          line: 91,
          column: 26
        }
      },
      "11": {
        start: {
          line: 98,
          column: 6
        },
        end: {
          line: 98,
          column: 8
        }
      },
      "12": {
        start: {
          line: 99,
          column: 2
        },
        end: {
          line: 114,
          column: 5
        }
      },
      "13": {
        start: {
          line: 100,
          column: 4
        },
        end: {
          line: 113,
          column: 5
        }
      },
      "14": {
        start: {
          line: 101,
          column: 6
        },
        end: {
          line: 108,
          column: 8
        }
      },
      "15": {
        start: {
          line: 110,
          column: 6
        },
        end: {
          line: 112,
          column: 8
        }
      },
      "16": {
        start: {
          line: 115,
          column: 2
        },
        end: {
          line: 115,
          column: 18
        }
      },
      "17": {
        start: {
          line: 122,
          column: 2
        },
        end: {
          line: 135,
          column: 5
        }
      },
      "18": {
        start: {
          line: 123,
          column: 15
        },
        end: {
          line: 127,
          column: 23
        }
      },
      "19": {
        start: {
          line: 128,
          column: 4
        },
        end: {
          line: 134,
          column: 6
        }
      }
    },
    fnMap: {
      "0": {
        name: "prepareDetector",
        decl: {
          start: {
            line: 37,
            column: 16
          },
          end: {
            line: 37,
            column: 31
          }
        },
        loc: {
          start: {
            line: 41,
            column: 12
          },
          end: {
            line: 53,
            column: 1
          }
        },
        line: 41
      },
      "1": {
        name: "formikToSimpleAggregation",
        decl: {
          start: {
            line: 55,
            column: 16
          },
          end: {
            line: 55,
            column: 41
          }
        },
        loc: {
          start: {
            line: 55,
            column: 71
          },
          end: {
            line: 69,
            column: 1
          }
        },
        line: 55
      },
      "2": {
        name: "formikToAggregation",
        decl: {
          start: {
            line: 71,
            column: 16
          },
          end: {
            line: 71,
            column: 35
          }
        },
        loc: {
          start: {
            line: 71,
            column: 66
          },
          end: {
            line: 84,
            column: 1
          }
        },
        line: 71
      },
      "3": {
        name: "formikToFeatures",
        decl: {
          start: {
            line: 86,
            column: 16
          },
          end: {
            line: 86,
            column: 32
          }
        },
        loc: {
          start: {
            line: 89,
            column: 2
          },
          end: {
            line: 92,
            column: 1
          }
        },
        line: 89
      },
      "4": {
        name: "formikToUIMetadata",
        decl: {
          start: {
            line: 94,
            column: 16
          },
          end: {
            line: 94,
            column: 34
          }
        },
        loc: {
          start: {
            line: 94,
            column: 67
          },
          end: {
            line: 116,
            column: 1
          }
        },
        line: 94
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 99,
            column: 17
          },
          end: {
            line: 99,
            column: 18
          }
        },
        loc: {
          start: {
            line: 99,
            column: 26
          },
          end: {
            line: 114,
            column: 3
          }
        },
        line: 99
      },
      "6": {
        name: "formikToFeatureAttributes",
        decl: {
          start: {
            line: 118,
            column: 9
          },
          end: {
            line: 118,
            column: 34
          }
        },
        loc: {
          start: {
            line: 121,
            column: 23
          },
          end: {
            line: 136,
            column: 1
          }
        },
        line: 121
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 122,
            column: 20
          },
          end: {
            line: 122,
            column: 21
          }
        },
        loc: {
          start: {
            line: 122,
            column: 36
          },
          end: {
            line: 135,
            column: 3
          }
        },
        line: 122
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 40,
            column: 2
          },
          end: {
            line: 40,
            column: 29
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 40,
            column: 24
          },
          end: {
            line: 40,
            column: 29
          }
        }],
        line: 40
      },
      "1": {
        loc: {
          start: {
            line: 56,
            column: 2
          },
          end: {
            line: 68,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 56,
            column: 2
          },
          end: {
            line: 68,
            column: 3
          }
        }, {
          start: {
            line: 56,
            column: 2
          },
          end: {
            line: 68,
            column: 3
          }
        }],
        line: 56
      },
      "2": {
        loc: {
          start: {
            line: 57,
            column: 4
          },
          end: {
            line: 59,
            column: 34
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 57,
            column: 4
          },
          end: {
            line: 57,
            column: 23
          }
        }, {
          start: {
            line: 58,
            column: 4
          },
          end: {
            line: 58,
            column: 23
          }
        }, {
          start: {
            line: 59,
            column: 4
          },
          end: {
            line: 59,
            column: 34
          }
        }],
        line: 57
      },
      "3": {
        loc: {
          start: {
            line: 72,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 72,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        }, {
          start: {
            line: 72,
            column: 2
          },
          end: {
            line: 82,
            column: 3
          }
        }],
        line: 72
      },
      "4": {
        loc: {
          start: {
            line: 73,
            column: 11
          },
          end: {
            line: 81,
            column: 10
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 76,
            column: 8
          },
          end: {
            line: 80,
            column: 9
          }
        }, {
          start: {
            line: 81,
            column: 8
          },
          end: {
            line: 81,
            column: 10
          }
        }],
        line: 73
      },
      "5": {
        loc: {
          start: {
            line: 73,
            column: 11
          },
          end: {
            line: 75,
            column: 37
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 73,
            column: 11
          },
          end: {
            line: 73,
            column: 31
          }
        }, {
          start: {
            line: 74,
            column: 6
          },
          end: {
            line: 74,
            column: 26
          }
        }, {
          start: {
            line: 75,
            column: 6
          },
          end: {
            line: 75,
            column: 37
          }
        }],
        line: 73
      },
      "6": {
        loc: {
          start: {
            line: 100,
            column: 4
          },
          end: {
            line: 113,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 100,
            column: 4
          },
          end: {
            line: 113,
            column: 5
          }
        }, {
          start: {
            line: 100,
            column: 4
          },
          end: {
            line: 113,
            column: 5
          }
        }],
        line: 100
      },
      "7": {
        loc: {
          start: {
            line: 105,
            column: 10
          },
          end: {
            line: 107,
            column: 23
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 106,
            column: 14
          },
          end: {
            line: 106,
            column: 42
          }
        }, {
          start: {
            line: 107,
            column: 14
          },
          end: {
            line: 107,
            column: 23
          }
        }],
        line: 105
      },
      "8": {
        loc: {
          start: {
            line: 105,
            column: 10
          },
          end: {
            line: 105,
            column: 59
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 105,
            column: 10
          },
          end: {
            line: 105,
            column: 29
          }
        }, {
          start: {
            line: 105,
            column: 33
          },
          end: {
            line: 105,
            column: 59
          }
        }],
        line: 105
      },
      "9": {
        loc: {
          start: {
            line: 123,
            column: 15
          },
          end: {
            line: 127,
            column: 23
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 124,
            column: 8
          },
          end: {
            line: 124,
            column: 23
          }
        }, {
          start: {
            line: 125,
            column: 8
          },
          end: {
            line: 127,
            column: 23
          }
        }],
        line: 123
      },
      "10": {
        loc: {
          start: {
            line: 125,
            column: 8
          },
          end: {
            line: 127,
            column: 23
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 126,
            column: 8
          },
          end: {
            line: 126,
            column: 17
          }
        }, {
          start: {
            line: 127,
            column: 8
          },
          end: {
            line: 127,
            column: 23
          }
        }],
        line: 125
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0
    },
    b: {
      "0": [0],
      "1": [0, 0],
      "2": [0, 0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "6f05395d6a30344785ebd6c9340d68bb32a013f1"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_1vekg96fvu = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}

cov_1vekg96fvu();

/*
 * Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License").
 * You may not use this file except in compliance with the License.
 * A copy of the License is located at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * or in the "license" file accompanying this file. This file is distributed
 * on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */
import { snakeCase, cloneDeep } from 'lodash';
import { Detector, FeatureAttributes, FEATURE_TYPE, UiFeature } from '../../../../models/interfaces';
import { AggregationOption } from '../../models/types';
export interface FeaturesFormikValues {
  featureId: string;
  featureName: string;
  featureType: FEATURE_TYPE;
  featureEnabled: boolean;
  aggregationQuery: string;
  aggregationBy?: string;
  aggregationOf?: AggregationOption[];
  newFeature?: boolean;
}
export function prepareDetector(values: FeaturesFormikValues[], ad: Detector, forPreview: boolean = (cov_1vekg96fvu().b[0][0]++, false)): Detector {
  cov_1vekg96fvu().f[0]++;
  const detector = (cov_1vekg96fvu().s[0]++, cloneDeep(ad));
  const featureAttributes = (cov_1vekg96fvu().s[1]++, formikToFeatures(values, forPreview));
  cov_1vekg96fvu().s[2]++;
  return { ...detector,
    featureAttributes: [...featureAttributes],
    uiMetadata: { ...detector.uiMetadata,
      features: { ...formikToUIMetadata(values)
      }
    }
  };
}
export function formikToSimpleAggregation(value: FeaturesFormikValues) {
  cov_1vekg96fvu().f[1]++;
  cov_1vekg96fvu().s[3]++;

  if ((cov_1vekg96fvu().b[2][0]++, value.aggregationBy) && (cov_1vekg96fvu().b[2][1]++, value.aggregationOf) && (cov_1vekg96fvu().b[2][2]++, value.aggregationOf.length > 0)) {
    cov_1vekg96fvu().b[1][0]++;
    cov_1vekg96fvu().s[4]++;
    return {
      [value.featureName]: {
        [value.aggregationBy]: {
          field: value.aggregationOf[0].label
        }
      }
    };
  } else {
    cov_1vekg96fvu().b[1][1]++;
    cov_1vekg96fvu().s[5]++;
    return {};
  }
}
export function formikToAggregation(values: FeaturesFormikValues) {
  cov_1vekg96fvu().f[2]++;
  cov_1vekg96fvu().s[6]++;

  if (values.featureType === FEATURE_TYPE.SIMPLE) {
    cov_1vekg96fvu().b[3][0]++;
    cov_1vekg96fvu().s[7]++;
    return (cov_1vekg96fvu().b[5][0]++, values.aggregationBy) && (cov_1vekg96fvu().b[5][1]++, values.aggregationOf) && (cov_1vekg96fvu().b[5][2]++, values.aggregationOf.length > 0) ? (cov_1vekg96fvu().b[4][0]++, {
      [snakeCase(values.featureName)]: {
        [values.aggregationBy]: {
          field: values.aggregationOf[0].label
        }
      }
    }) : (cov_1vekg96fvu().b[4][1]++, {});
  } else {
    cov_1vekg96fvu().b[3][1]++;
  }

  cov_1vekg96fvu().s[8]++;
  return JSON.parse(values.aggregationQuery);
}
export function formikToFeatures(values: FeaturesFormikValues[], forPreview: boolean) {
  cov_1vekg96fvu().f[3]++;
  const featureAttribute = (cov_1vekg96fvu().s[9]++, formikToFeatureAttributes(values, forPreview));
  cov_1vekg96fvu().s[10]++;
  return featureAttribute;
}
export function formikToUIMetadata(values: FeaturesFormikValues[]) {
  cov_1vekg96fvu().f[4]++;
  // TODO:: Delete Stale metadata if name is changed
  let features: {
    [key: string]: UiFeature;
  } = (cov_1vekg96fvu().s[11]++, {});
  cov_1vekg96fvu().s[12]++;
  values.forEach(value => {
    cov_1vekg96fvu().f[5]++;
    cov_1vekg96fvu().s[13]++;

    if (value.featureType === FEATURE_TYPE.SIMPLE) {
      cov_1vekg96fvu().b[6][0]++;
      cov_1vekg96fvu().s[14]++;
      features[value.featureName] = {
        featureType: value.featureType,
        aggregationBy: value.aggregationBy,
        aggregationOf: (cov_1vekg96fvu().b[8][0]++, value.aggregationOf) && (cov_1vekg96fvu().b[8][1]++, value.aggregationOf.length) ? (cov_1vekg96fvu().b[7][0]++, value.aggregationOf[0].label) : (cov_1vekg96fvu().b[7][1]++, undefined)
      };
    } else {
      cov_1vekg96fvu().b[6][1]++;
      cov_1vekg96fvu().s[15]++;
      features[value.featureName] = {
        featureType: value.featureType
      };
    }
  });
  cov_1vekg96fvu().s[16]++;
  return features;
}

function formikToFeatureAttributes(values: FeaturesFormikValues[], forPreview: boolean): FeatureAttributes[] {
  cov_1vekg96fvu().f[6]++;
  cov_1vekg96fvu().s[17]++;
  return values.map(function (value) {
    cov_1vekg96fvu().f[7]++;
    const id = (cov_1vekg96fvu().s[18]++, forPreview ? (cov_1vekg96fvu().b[9][0]++, value.featureId) : (cov_1vekg96fvu().b[9][1]++, value.newFeature ? (cov_1vekg96fvu().b[10][0]++, undefined) : (cov_1vekg96fvu().b[10][1]++, value.featureId)));
    cov_1vekg96fvu().s[19]++;
    return {
      featureId: id,
      featureName: value.featureName,
      featureEnabled: value.featureEnabled,
      importance: 1,
      aggregationQuery: formikToAggregation(value)
    };
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm1pa1RvRmVhdHVyZXMudHMiXSwibmFtZXMiOlsic25ha2VDYXNlIiwiY2xvbmVEZWVwIiwiRGV0ZWN0b3IiLCJGZWF0dXJlQXR0cmlidXRlcyIsIkZFQVRVUkVfVFlQRSIsIlVpRmVhdHVyZSIsIkFnZ3JlZ2F0aW9uT3B0aW9uIiwiRmVhdHVyZXNGb3JtaWtWYWx1ZXMiLCJmZWF0dXJlSWQiLCJmZWF0dXJlTmFtZSIsImZlYXR1cmVUeXBlIiwiZmVhdHVyZUVuYWJsZWQiLCJhZ2dyZWdhdGlvblF1ZXJ5IiwiYWdncmVnYXRpb25CeSIsImFnZ3JlZ2F0aW9uT2YiLCJuZXdGZWF0dXJlIiwicHJlcGFyZURldGVjdG9yIiwidmFsdWVzIiwiYWQiLCJmb3JQcmV2aWV3IiwiZGV0ZWN0b3IiLCJmZWF0dXJlQXR0cmlidXRlcyIsImZvcm1pa1RvRmVhdHVyZXMiLCJ1aU1ldGFkYXRhIiwiZmVhdHVyZXMiLCJmb3JtaWtUb1VJTWV0YWRhdGEiLCJmb3JtaWtUb1NpbXBsZUFnZ3JlZ2F0aW9uIiwidmFsdWUiLCJsZW5ndGgiLCJmaWVsZCIsImxhYmVsIiwiZm9ybWlrVG9BZ2dyZWdhdGlvbiIsIlNJTVBMRSIsIkpTT04iLCJwYXJzZSIsImZlYXR1cmVBdHRyaWJ1dGUiLCJmb3JtaWtUb0ZlYXR1cmVBdHRyaWJ1dGVzIiwia2V5IiwiZm9yRWFjaCIsInVuZGVmaW5lZCIsIm1hcCIsImlkIiwiaW1wb3J0YW5jZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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d0IsU0FEQSxrQ0FFQVosS0FBSyxDQUFDbkIsU0FGTixDQUZpQixDQUFiLENBQVI7QUFEZ0M7QUFNaEMsV0FBTztBQUNMQSxNQUFBQSxTQUFTLEVBQUVpQyxFQUROO0FBRUxoQyxNQUFBQSxXQUFXLEVBQUVrQixLQUFLLENBQUNsQixXQUZkO0FBR0xFLE1BQUFBLGNBQWMsRUFBRWdCLEtBQUssQ0FBQ2hCLGNBSGpCO0FBSUwrQixNQUFBQSxVQUFVLEVBQUUsQ0FKUDtBQUtMOUIsTUFBQUEsZ0JBQWdCLEVBQUVtQixtQkFBbUIsQ0FBQ0osS0FBRDtBQUxoQyxLQUFQO0FBT0QsR0FiTSxDQUFQO0FBY0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IDIwMjAgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpLlxuICogWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogQSBjb3B5IG9mIHRoZSBMaWNlbnNlIGlzIGxvY2F0ZWQgYXRcbiAqXG4gKiBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBvciBpbiB0aGUgXCJsaWNlbnNlXCIgZmlsZSBhY2NvbXBhbnlpbmcgdGhpcyBmaWxlLiBUaGlzIGZpbGUgaXMgZGlzdHJpYnV0ZWRcbiAqIG9uIGFuIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlclxuICogZXhwcmVzcyBvciBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmdcbiAqIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBzbmFrZUNhc2UsIGNsb25lRGVlcCB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQge1xuICBEZXRlY3RvcixcbiAgRmVhdHVyZUF0dHJpYnV0ZXMsXG4gIEZFQVRVUkVfVFlQRSxcbiAgVWlGZWF0dXJlLFxufSBmcm9tICcuLi8uLi8uLi8uLi9tb2RlbHMvaW50ZXJmYWNlcyc7XG5cbmltcG9ydCB7IEFnZ3JlZ2F0aW9uT3B0aW9uIH0gZnJvbSAnLi4vLi4vbW9kZWxzL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBGZWF0dXJlc0Zvcm1pa1ZhbHVlcyB7XG4gIGZlYXR1cmVJZDogc3RyaW5nO1xuICBmZWF0dXJlTmFtZTogc3RyaW5nO1xuICBmZWF0dXJlVHlwZTogRkVBVFVSRV9UWVBFO1xuICBmZWF0dXJlRW5hYmxlZDogYm9vbGVhbjtcbiAgYWdncmVnYXRpb25RdWVyeTogc3RyaW5nO1xuICBhZ2dyZWdhdGlvbkJ5Pzogc3RyaW5nO1xuICBhZ2dyZWdhdGlvbk9mPzogQWdncmVnYXRpb25PcHRpb25bXTtcbiAgbmV3RmVhdHVyZT86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmVwYXJlRGV0ZWN0b3IoXG4gIHZhbHVlczogRmVhdHVyZXNGb3JtaWtWYWx1ZXNbXSxcbiAgYWQ6IERldGVjdG9yLFxuICBmb3JQcmV2aWV3OiBib29sZWFuID0gZmFsc2Vcbik6IERldGVjdG9yIHtcbiAgY29uc3QgZGV0ZWN0b3IgPSBjbG9uZURlZXAoYWQpO1xuICBjb25zdCBmZWF0dXJlQXR0cmlidXRlcyA9IGZvcm1pa1RvRmVhdHVyZXModmFsdWVzLCBmb3JQcmV2aWV3KTtcblxuICByZXR1cm4ge1xuICAgIC4uLmRldGVjdG9yLFxuICAgIGZlYXR1cmVBdHRyaWJ1dGVzOiBbLi4uZmVhdHVyZUF0dHJpYnV0ZXNdLFxuICAgIHVpTWV0YWRhdGE6IHtcbiAgICAgIC4uLmRldGVjdG9yLnVpTWV0YWRhdGEsXG4gICAgICBmZWF0dXJlczogeyAuLi5mb3JtaWtUb1VJTWV0YWRhdGEodmFsdWVzKSB9LFxuICAgIH0sXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtaWtUb1NpbXBsZUFnZ3JlZ2F0aW9uKHZhbHVlOiBGZWF0dXJlc0Zvcm1pa1ZhbHVlcykge1xuICBpZiAoXG4gICAgdmFsdWUuYWdncmVnYXRpb25CeSAmJlxuICAgIHZhbHVlLmFnZ3JlZ2F0aW9uT2YgJiZcbiAgICB2YWx1ZS5hZ2dyZWdhdGlvbk9mLmxlbmd0aCA+IDBcbiAgKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIFt2YWx1ZS5mZWF0dXJlTmFtZV06IHtcbiAgICAgICAgW3ZhbHVlLmFnZ3JlZ2F0aW9uQnldOiB7IGZpZWxkOiB2YWx1ZS5hZ2dyZWdhdGlvbk9mWzBdLmxhYmVsIH0sXG4gICAgICB9LFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtaWtUb0FnZ3JlZ2F0aW9uKHZhbHVlczogRmVhdHVyZXNGb3JtaWtWYWx1ZXMpIHtcbiAgaWYgKHZhbHVlcy5mZWF0dXJlVHlwZSA9PT0gRkVBVFVSRV9UWVBFLlNJTVBMRSkge1xuICAgIHJldHVybiB2YWx1ZXMuYWdncmVnYXRpb25CeSAmJlxuICAgICAgdmFsdWVzLmFnZ3JlZ2F0aW9uT2YgJiZcbiAgICAgIHZhbHVlcy5hZ2dyZWdhdGlvbk9mLmxlbmd0aCA+IDBcbiAgICAgID8ge1xuICAgICAgICAgIFtzbmFrZUNhc2UodmFsdWVzLmZlYXR1cmVOYW1lKV06IHtcbiAgICAgICAgICAgIFt2YWx1ZXMuYWdncmVnYXRpb25CeV06IHsgZmllbGQ6IHZhbHVlcy5hZ2dyZWdhdGlvbk9mWzBdLmxhYmVsIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgOiB7fTtcbiAgfVxuICByZXR1cm4gSlNPTi5wYXJzZSh2YWx1ZXMuYWdncmVnYXRpb25RdWVyeSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JtaWtUb0ZlYXR1cmVzKFxuICB2YWx1ZXM6IEZlYXR1cmVzRm9ybWlrVmFsdWVzW10sXG4gIGZvclByZXZpZXc6IGJvb2xlYW5cbikge1xuICBjb25zdCBmZWF0dXJlQXR0cmlidXRlID0gZm9ybWlrVG9GZWF0dXJlQXR0cmlidXRlcyh2YWx1ZXMsIGZvclByZXZpZXcpO1xuICByZXR1cm4gZmVhdHVyZUF0dHJpYnV0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1pa1RvVUlNZXRhZGF0YSh2YWx1ZXM6IEZlYXR1cmVzRm9ybWlrVmFsdWVzW10pIHtcbiAgLy8gVE9ETzo6IERlbGV0ZSBTdGFsZSBtZXRhZGF0YSBpZiBuYW1lIGlzIGNoYW5nZWRcbiAgbGV0IGZlYXR1cmVzOiB7XG4gICAgW2tleTogc3RyaW5nXTogVWlGZWF0dXJlO1xuICB9ID0ge307XG4gIHZhbHVlcy5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICBpZiAodmFsdWUuZmVhdHVyZVR5cGUgPT09IEZFQVRVUkVfVFlQRS5TSU1QTEUpIHtcbiAgICAgIGZlYXR1cmVzW3ZhbHVlLmZlYXR1cmVOYW1lXSA9IHtcbiAgICAgICAgZmVhdHVyZVR5cGU6IHZhbHVlLmZlYXR1cmVUeXBlLFxuICAgICAgICBhZ2dyZWdhdGlvbkJ5OiB2YWx1ZS5hZ2dyZWdhdGlvbkJ5LFxuICAgICAgICBhZ2dyZWdhdGlvbk9mOlxuICAgICAgICAgIHZhbHVlLmFnZ3JlZ2F0aW9uT2YgJiYgdmFsdWUuYWdncmVnYXRpb25PZi5sZW5ndGhcbiAgICAgICAgICAgID8gdmFsdWUuYWdncmVnYXRpb25PZlswXS5sYWJlbFxuICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBmZWF0dXJlc1t2YWx1ZS5mZWF0dXJlTmFtZV0gPSB7XG4gICAgICAgIGZlYXR1cmVUeXBlOiB2YWx1ZS5mZWF0dXJlVHlwZSxcbiAgICAgIH07XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGZlYXR1cmVzO1xufVxuXG5mdW5jdGlvbiBmb3JtaWtUb0ZlYXR1cmVBdHRyaWJ1dGVzKFxuICB2YWx1ZXM6IEZlYXR1cmVzRm9ybWlrVmFsdWVzW10sXG4gIGZvclByZXZpZXc6IGJvb2xlYW5cbik6IEZlYXR1cmVBdHRyaWJ1dGVzW10ge1xuICByZXR1cm4gdmFsdWVzLm1hcChmdW5jdGlvbih2YWx1ZSkge1xuICAgIGNvbnN0IGlkID0gZm9yUHJldmlld1xuICAgICAgPyB2YWx1ZS5mZWF0dXJlSWRcbiAgICAgIDogdmFsdWUubmV3RmVhdHVyZVxuICAgICAgPyB1bmRlZmluZWRcbiAgICAgIDogdmFsdWUuZmVhdHVyZUlkO1xuICAgIHJldHVybiB7XG4gICAgICBmZWF0dXJlSWQ6IGlkLFxuICAgICAgZmVhdHVyZU5hbWU6IHZhbHVlLmZlYXR1cmVOYW1lLFxuICAgICAgZmVhdHVyZUVuYWJsZWQ6IHZhbHVlLmZlYXR1cmVFbmFibGVkLFxuICAgICAgaW1wb3J0YW5jZTogMSxcbiAgICAgIGFnZ3JlZ2F0aW9uUXVlcnk6IGZvcm1pa1RvQWdncmVnYXRpb24odmFsdWUpLFxuICAgIH07XG4gIH0pO1xufVxuIl19